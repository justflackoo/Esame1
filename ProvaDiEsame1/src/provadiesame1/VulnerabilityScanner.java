package provadiesame1;
import java.util.Scanner;
import java.io.IOException;
import java.util.NoSuchElementException;
import java.nio.file.Paths;

/**
 *
 * @author giuse
 */
public class VulnerabilityScanner {
    public static void main(String[] args){
        loadFromFile();
        Lista lista = new Lista();
        HWVulnerability h1 = new HWVulnerability(5,true,"H1");
        HWVulnerability h2 = new HWVulnerability(2,true,"H2");
        HWVulnerability h3 = new HWVulnerability(3,false,"H3");
        SWVulnerability s1 = new SWVulnerability(4,true,"S1",10);
        SWVulnerability s2 = new SWVulnerability(4,false,"S2",60);
        SWVulnerability s3 = new SWVulnerability(2,false,"S3",80);
        SWVulnerability s4 = new SWVulnerability(2,true,"S4",9);
        
        lista.append(h1);
        lista.append(h2);
        lista.append(h3);
        lista.append(s1);
        lista.append(s2);
        lista.append(s3);
        lista.append(s4);
        
        System.out.println("\n");
        lista.print();
        
        lista.numberExploitable();

        
        lista.rimuovi(h1);
        lista.rimuovi(s1);
        lista.rimuovi(s4);

        System.out.println("\nStampa post remove, devono esserci H2,H3,S2,S3");
        lista.print();
        
        lista.append(s1);
        lista.append(s4);
        lista.append(h1);

        System.out.println("\nStampa post append, devono esserci tutti");
        lista.print();
        lista.removeNotExploitable();
        System.out.println("\nStampa post removeNotExploitable, devono esserci H2,S1,S4,H1");
        lista.print();
        
               

        
        
        
        
        
        
    }
    
    public static void loadFromFile(){
        Lista l = new Lista();
        
        try{
            Scanner input = new Scanner(Paths.get("Vulnerabilita.txt"));
            int numElementi = input.nextInt();
            System.out.println("Elementi presenti nella lista: "+numElementi);
            for(int i=0; i<numElementi;i++){
                String className;
                className = input.next();
                if(className.equals("Vulnerability.HW")){
                    HWVulnerability HW = new HWVulnerability(input.nextInt(),input.nextBoolean(),input.next());
                    l.append(HW);
                }else{
                    SWVulnerability SW = new SWVulnerability(input.nextInt(),input.nextBoolean(),input.next(),input.nextInt());
                    l.append(SW);
                }
            }
            input.close();
            l.print();
            
        }catch(IOException | NoSuchElementException e){
            e.printStackTrace();
        }
    }
    
}
